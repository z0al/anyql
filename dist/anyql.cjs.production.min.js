"use strict";var e=require("redux-saga/effects"),r=require("redux"),t=require("reselect");function n(){return(n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function a(e,r){function t(){if(r){var t=r.apply(void 0,arguments);if(!t)throw new Error("prepareAction did not return an object");return n({type:e,payload:t.payload},"meta"in t&&{meta:t.meta},{},"error"in t&&{error:t.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return t.toString=function(){return""+e},t.type=e,t}var u=a("query/error",(function(e,r){return{payload:{query:e,error:r}}})),c="query/cancel",o=a("query/result",(function(e,r,t){return{payload:{query:e,data:r,next:t}}})),i=regeneratorRuntime.mark(s);function s(r){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=[c];case 1:return n.next=4,e.take(t);case 4:if(n.sent.payload.query.id!==r.id){n.next=10;break}return n.next=9,!0;case 9:return n.abrupt("return",n.sent);case 10:n.next=1;break;case 12:case"end":return n.stop()}}),i)}function d(e){return void 0!==e}var p=Array.isArray,l=r.combineReducers({queries:function(e,r){switch(void 0===e&&(e={}),r.type){case"query/fetch":var t,a=r.payload.query,u=n({},e[a.id])||{};return u.id=a.id,u.loading=!0,u.type=a.type||"query",p(u.dataIds)||(u.dataIds=[]),n({},e,((t={})[a.id]=u,t));case"query/error":var c,o=r.payload,i=o.query,s=o.error,d=n({},e[i.id])||{};return d.error=s,d.loading=!1,n({},e,((c={})[i.id]=d,c));case"query/result":var l,y=r.payload,f=y.query,x=y.data,v=y.next,q=n({},e[f.id])||{};q.loading=!1,q.next=v;var b=x.map((function(e){return e.id}));return p(q.dataIds)&&b.push.apply(b,q.dataIds),q.dataIds=Array.from(new Set(b)),n({},e,((l={})[f.id]=q,l))}return e},objects:function(e,r){return void 0===e&&(e={}),e}}),y=t.createSelector((function(e){return e.queries}),(function(e,r){return r}),(function(e,r){return e[r]})),f=regeneratorRuntime.mark(x);function x(r,t){var n,a,c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.select((function(e){return y(e,r.id)}));case 2:return n={next:i.sent.next},i.prev=5,i.next=8,e.race({result:e.call(t,n),cancelled:e.call(s,r)});case 8:if(!(a=i.sent).cancelled){i.next=11;break}return i.abrupt("return");case 11:if(!d((c=a.result).error)){i.next=14;break}throw c.error;case 14:if(!d(c.data)){i.next=17;break}return i.next=17,e.put(o(r,p(c.data)?c.data:[c.data],c.next));case 17:i.next=24;break;case 19:return i.prev=19,i.t0=i.catch(5),i.next=23,e.put(u(r,i.t0));case 23:return i.abrupt("return",i.sent);case 24:case"end":return i.stop()}}),f,null,[[5,19]])}exports.createEngine=function(r){return{reducer:l,engine:(t=r.resolver,regeneratorRuntime.mark((function r(){var n,a,u,c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=["query/fetch"],r.next=3,e.actionChannel(n);case 3:a=r.sent;case 4:return r.next=7,e.take(a);case 7:return c=(u=r.sent).payload.query,r.next=11,e.call(t,c);case 11:if(o=r.sent,"query/fetch"!==u.type){r.next=15;break}return r.next=15,e.spawn(x,c,o);case 15:r.next=4;break;case 17:case"end":return r.stop()}}),r)})))};var t};
//# sourceMappingURL=anyql.cjs.production.min.js.map
